<div class="max-w-5xl mx-auto bg-white p-6 rounded-xl shadow-md mt-6">
  <h2 class="text-3xl font-bold text-indigo-700 mb-6 text-center">ğŸ›’ Tu Carrito</h2>

  {{#if hasProducts}}
    <table class="table-auto w-full border border-gray-200 rounded-lg mb-6">
      <thead class="bg-indigo-600 text-white">
        <tr>
          <th class="py-3 px-4 text-left">Producto</th>
          <th class="py-3 px-4 text-center">Cantidad</th>
          <th class="py-3 px-4 text-center">Precio Unitario</th>
          <th class="py-3 px-4 text-center">Subtotal</th>
        </tr>
      </thead>
      <tbody>
        {{#each products}}
          <tr class="border-b hover:bg-gray-50">
            <td class="py-3 px-4">{{this.title}}</td>
            <td class="py-3 px-4 text-center">{{this.quantity}}</td>
            <td class="py-3 px-4 text-center">${{this.price}}</td>
            <td class="py-3 px-4 text-center font-semibold">${{this.total}}</td>
          </tr>
        {{/each}}
      </tbody>
    </table>

    <!-- ğŸ§® Total -->
    <div class="text-right mb-6">
      <p class="text-xl font-bold text-indigo-700">
        Total: ${{totalPrice}}
      </p>
    </div>

    <!-- ğŸ”˜ Botones -->
    <div class="flex justify-between">
      <button
        id="clearCartBtn"
        class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition"
      >
        ğŸ—‘ï¸ Vaciar carrito
      </button>

      <a
        href="/products"
        class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 transition"
      >
        â¬…ï¸ Seguir comprando
      </a>
    </div>
  {{else}}
    <div class="text-center py-10">
      <p class="text-lg text-gray-700 mb-4">Tu carrito estÃ¡ vacÃ­o ğŸ˜¢</p>
      <a
        href="/products"
        class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 transition"
      >
        ğŸ›ï¸ Ir al catÃ¡logo
      </a>
    </div>
  {{/if}}
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const clearCartBtn = document.getElementById('clearCartBtn');
    const cartId = '{{cartId}}';

    if (clearCartBtn) {
      clearCartBtn.addEventListener('click', async () => {
        if (confirm('Â¿Seguro que deseas vaciar el carrito completo?')) {
          try {
            const res = await fetch(`/api/carts/${cartId}`, { method: 'DELETE' });
            const data = await res.json();

            if (data.status === 'success') {
              alert('ğŸ§¹ Carrito vaciado exitosamente.');
              window.location.reload();
            } else {
              alert('âŒ No se pudo vaciar el carrito.');
            }
          } catch (error) {
            console.error('Error al vaciar carrito:', error);
            alert('âš ï¸ Error al intentar vaciar el carrito.');
          }
        }
      });
    }
  });
</script>
